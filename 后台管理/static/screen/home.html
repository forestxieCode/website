<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<meta http-equiv="x-ua-compatible" content="ie=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="renderer" content="webkit|ie-comp|ie-stand">
		<meta name="x5-orientation" content="landscape/portrait">
		<meta name="x5-page-mode" content="app">
		<meta name="x5-fullscreen" content="true">
		<link rel="stylesheet" href="font/iconfont.css">
		<link rel="stylesheet" type="text/css" href="css/index.css" />
		<title>预案启动页</title>
	</head>

	<body>
		<header>
			<h1><img src="img/icon_1.png" alt="">广东粤电集团应急指挥中心</h1>
			<section class="part-date">
				<div id="current-date">
					当前时间：<span>19:52:20</span>
				</div>
				<div id="current-time">
					距离预案启动<span>3</span>小时<span>20</span>分
				</div>
			</section>
			<section class="part-weather">
				<iframe width="300" scrolling="no" height="18" frameborder="0" allowtransparency="true" src="//i.tianqi.com/index.php?c=code&id=1&color=%23FFFFFF&icon=1&wind=1&num=1&site=16"></iframe>
			</section>
		</header>
		<div class="container">
			<div class="table">
				<div class="title">
					<div class="title-text">应急组织人员</div>
				</div>
				<div class="table-content"></div>
				<ul class="but-list">
					<li class="but but1"><i class="iconfont icon-yuyin"></i>语音通话</li>
					<li class="but but2"><i class="iconfont icon-shexiangtou"></i>视频通话</li>
					<li class="but but3"><i class="iconfont icon-xiaoxi"></i>发短信</li>
				</ul>
			</div>
			<div class="panels">
				<div class="panel" style="margin-bottom: 30px;">
					<div class="title">
						<div class="title-text">文字信息发布</div>
					</div>
					<ul class="list_1">
						<li>
							<div class="tit">
								<span class="name">张长弓：</span>
								<span class="time">2018-11-06 19:56:23</span>
							</div>
							<p>发生什么事情了？</p>
						</li>
						<li>
							<div class="tit">
								<span class="name">张长弓：</span>
								<span class="time">2018-11-06 19:56:23</span>
							</div>
							<p>珠海遭台风影响，有人受伤...</p>
						</li>
						<li>
							<div class="tit">
								<span class="name">张长弓：</span>
								<span class="time">2018-11-06 19:56:23</span>
							</div>
							<p>伙伴们，伙伴们需要支援！！！</p>
						</li>
						<li>
							<div class="tit">
								<span class="name">张长弓：</span>
								<span class="time">2018-11-06 19:56:23</span>
							</div>
							<p>有人在么？呼叫！呼叫！！</p>
						</li>
					</ul>
				</div>
				<div class="panel">
					<div class="title">
						<div class="title-text">语音、视频、通话</div>
					</div>
					<ul class="list_2">
						<li>
							<div class="name">张长弓</div>
							<div class="type"><i class="iconfont icon-hujiao"></i>通话中...</div>
						</li>
						<li>
							<div class="name">张长弓</div>
							<div class="types"><i class="iconfont icon-weibiaoti--"></i>准备呼叫</div>
						</li>
					</ul>
				</div>
			</div>
			<div class="video">
				<div class="title">
					<div class="title-text">
						<div class="tabBut">视频会议</div>
						<div class="tabBut active">监控</div>
						<div class="tabBut">地图</div>
					</div>
				</div>
				<div class="tab-content">

				</div>
				<div class="tab-content active">
					<div class="c-v-list active">
						<div class="c-vs c-vs-4">
							<div class="video-title">
								<div class="name">监控画面1</div>
								<div class="but">切换</div>
							</div>
							<div class="c-vs-video">

							</div>
							<div class="zoomBut">
								<img src="img/zoomBut_1.png" alt="">
							</div>
						</div>
						<div class="c-vs c-vs-4">
							<div class="video-title">
								<div class="name">监控画面2</div>
								<div class="but">切换</div>
							</div>
							<div class="c-vs-video">

							</div>
							<div class="zoomBut">
								<img src="img/zoomBut_1.png" alt="">
							</div>
						</div>
						<div class="c-vs c-vs-4">
							<div class="video-title">
								<div class="name">监控画面3</div>
								<div class="but">切换</div>
							</div>
							<div class="c-vs-video">

							</div>
							<div class="zoomBut">
								<img src="img/zoomBut_1.png" alt="">
							</div>
						</div>
						<div class="c-vs c-vs-4">
							<div class="video-title">
								<div class="name">监控画面4</div>
								<div class="but">切换</div>
							</div>
							<div class="c-vs-video">

							</div>
							<div class="zoomBut">
								<img src="img/zoomBut_1.png" alt="">
							</div>
						</div>
					</div>
					<div class="c-v-list">
						<div class="c-vs-1">
							<div class="video-title">
								<div class="name">监控画面1</div>
								<div class="but">切换</div>
							</div>
							<div class="c-vs-video">
								<OBJECT classid="clsid:9BE31822-FDAD-461B-AD51-BE1D1C159921" codebase="http://downloads.videolan.org/pub/videolan/vlc-webplugins/2.0.6/npapi-vlc-2.0.6.tar.xz"
								 id="vlc1" name="vlc" events="True">
									<param name="ShowDisplay" value="http://192.168.0.164:8180/Video1.mp4" />
									<param name="AutoLoop" value="False" />
									<param name="AutoPlay" value="True" />
								</OBJECT>
							</div>
							<div class="zoomBut">
								<img src="img/zoomBut_2.png" alt="">
							</div>
							<div class="butList">
								<div class="but"><img src="img/icon_5.png" >播放</div>
								<div class="but"><img src="img/icon_6.png" >暂停</div>
								<div class="but"><img src="img/icon_7.png" >拍照</div>
								<div class="but"><img src="img/icon_8.png" >录制</div>
								<div class="but"><img src="img/icon_9.png" >停止</div>
							</div>
						</div>
					</div>
				</div>
				<div class="tab-content">
					<div id="bdMap"></div>
				</div>
			</div>
			<div class="material-list">
				<div class="title">
					<div class="title-text">应急物资调配</div>
				</div>
				<div class="material-top_box">
					<div class="material-top">
						<p>应急物资总数</p>
						<div class="num"></div>
					</div>
				</div>
				<ul class="material-detail"></ul>
			</div>
			<div class="popup popupOne">
				<div class="popup-left">
					<div class="search"><i class="iconfont icon-sousuo"></i><input type="text"></div>
					<div class="orgList"></div>
				</div>
				<div class="popup-right">
					<div class="selectedNumber">已选<strong>0</strong>/500</div>
					<ul class="selectedPeople"></ul>
				</div>
				<div class="butList">
					<div class="but" id="VoiceCancel">取消</div>
					<div class="but active" id="VoiceSure">确定</div>
				</div>
			</div>
			<div class="popup popupTow">
				<div class="popup-left">
					<div class="search"><i class="iconfont icon-sousuo"></i><input type="text"></div>
					<ul class="cameraList"></ul>
				</div>
				<div class="popup-right">
					<div class="splitScreen">
						<div class="tit">样式</div>
						<div class="splitScreenList">
							<div class="splitScreenFour">
								<span></span>
								<span></span>
								<span></span>
								<span></span>
							</div>
							<div class="splitScreenNine">
								<span></span>
								<span></span>
								<span></span>
								<span></span>
								<span></span>
								<span></span>
								<span></span>
								<span></span>
								<span></span>
							</div>
						</div>
					</div>
					<div class="monitorScreen">
						<div class="tit">位置</div>
						<ul class="monitorScreenList">
							<li class="v-s-4 active">
								<div class="number">监控1</div>
								<div class="name">湛江电厂</div>
								<div class="close"><i class="iconfont icon-guanbi"></i></div>
							</li>
							<li class="v-s-4">
								<div class="number">监控1</div>
								<div class="name">湛江电厂</div>
								<div class="close"><i class="iconfont icon-guanbi"></i></div>
							</li>
							<li class="v-s-4">
								<div class="number">监控1</div>
								<div class="name">湛江电厂</div>
								<div class="close"><i class="iconfont icon-guanbi"></i></div>
							</li>
							<li class="v-s-4">
								<div class="number">监控1</div>
								<div class="name">湛江电厂</div>
								<div class="close"><i class="iconfont icon-guanbi"></i></div>
							</li>
						</ul>
					</div>
					<div class="butList">
						<div class="but active" id="videoAdjustSure">确定</div>
						<div class="but" id="videoAdjustCancel">取消</div>
					</div>
				</div>
			</div>
			<div class="popup popupThree">
				<div class="popup-top">
					<p>您将发消息给<strong>0</strong>位应急人员：</p>
					<ul></ul>
				</div>
				<div class="popup-con">
					<textarea></textarea>
				</div>
				<div class="butList">
					<div class="but" id="newsCancel">取消</div>
					<div class="but active" id="newsSure">确定</div>
				</div>
			</div>
		</div>
		<script src="../lib/js/jquery.min.js"></script>
		<script src="../lib/js/common.js"></script>
		<script src="../lib/js/app.js"></script>
		<script src="js/layer/layer.js"></script>
		<script>

			var date = new Date()
			var materialStr = ''
			var materialList;
			var origanizeList
			var times = 1
			var currentDate = document.getElementById('current-date'); //计算当前日期
			var currentTime = document.getElementById('current-time'); //计算当前时间

			var planId = (window.location.href.split('=')[1] ? window.location.href.split('=')[1] : 1);
			console.log(planId)
			var script = document.createElement('script')
			script.src = 'http://api.map.baidu.com/api?v=3.0&ak=EOo2wNrZGNmPwENhIRpMikK1SMAdl0mu&callback=initialize'
			document.body.appendChild(script)

			var videoDistribution = [] //摄像头列表数据
			var videoSettingType = 1; //视频排列方式
			var CurrentScreenObj = ''

			var voiceCandidate = [] //语音通话已选人列表
			var newsCandidate = [] //短信已选人列表

			function getMaterialList() {
				$.ajax({
					type: 'GET',
					url: RES_HOST + '/plan/materialAllocate/getMaterialById/' + planId,
					success: function(res) {
						materialList = res.data.materials
            $('.num').html(`<span>${res.data.total}</span>/件`)
						if (materialList.length) {
							for (var i = 0; i < materialList.length; i++) {
                materialStr += `<li><div class="tit"><p>${materialList[i].materialName}
									</p><span class="fr">${materialList[i].amount}${materialList[i].unit}</span></div><div class="txt">存放地点：${materialList[i]
                  .place}</div><div class="txt"><span>责任人：${materialList[i].personLiable}</span><span class="fr">${materialList[i].phone}</span></div></li>`
							}
							$('.material-detail').html(materialStr)
						}
					}
				})
			}

			function initPageWidthHeight() {
				var screenHeight = $('body').height();
				var headHg = $('header').outerHeight()
				console.log(screenHeight, headHg)
				$('.container').height(screenHeight - headHg + 'px'); // 减去90header的高，减去60的h2的高，减去container上下20的margin

				var contHg = $('.panels').height()
				var titHg = $('.panel .title').height()

				var tableHg1 = $('.table .but-list').height()
				$('.table-content').height(contHg - titHg - tableHg1 - 10 + 'px')

				$('.panel').height((contHg - 30) / 2 + 'px')
				$('.panel ul').height((contHg - 30) / 2 - titHg - 20 + 'px')

				var cVsHg = (contHg - titHg - 30) / 2
				$('.tab-content').height(contHg - titHg - 20 + 'px')
				$('#bdMap').height(contHg - titHg - 20 + 'px')
				$('.c-vs').height(cVsHg + 'px')

				var materialHg1 = $('.material-list .material-top_box').height()
				$('.material-list ul').height(contHg - titHg - materialHg1 - 10 + 'px')
				//
				// 				var lineHeight = $('.c-v-swiper ul li').height();
				// 				$('.shebei').css('line-height', lineHeight + 'px')
			}

			function createNewsCandidate(){ //短信发送人员html渲染
				console.log(newsCandidate)
				var newsCandidateHtml = ''
				for (var i = 0; i < newsCandidate.length; i++) {
					newsCandidateHtml += '<li data-id="' + newsCandidate[i].id + '">' + newsCandidate[i].name + '；</li>'
				}
				$('.popup-top strong').text(newsCandidate.length)
				$('.popupThree .popup-top ul').html(newsCandidateHtml)
			}

			function createVoiceCandidate(){ //语音已选列表渲染和列表点击事件绑定
				var voiceCandidateHtml = ''
				for (var i = 0; i < voiceCandidate.length; i++) {
					voiceCandidateHtml += '<li data-id="' + voiceCandidate[i].id + '"><p>' + voiceCandidate[i].name + '</p><span>-</span></li>'
				}
				$('.selectedNumber strong').text(voiceCandidate.length)
				$('.selectedPeople').html(voiceCandidateHtml)
				$('.selectedPeople li span').on('click',function(){
					var id = $(this).parent().data('id');
					for (var i = 0; i < voiceCandidate.length; i++) {
						if(voiceCandidate[i].id == id){
							voiceCandidate.splice(i, 1);
						}
					}
					var arr = $('.user_list li');
					for (var i = 0; i < arr.length; i++) {
						if($(arr[i]).data('id') == id){
							$(arr[i]).removeClass('active')
						}
					}
					createVoiceCandidate()
				})
			}

			function getOriganizeList() { //获取公司组织架构
				$.ajax({
					type: 'GET',
					url: RES_HOST + '/plan/planOrg/' + planId,
					success: function(result) {
					  console.log('组织架构', result.data)
						origanizeList = result.data
						var peopleList = ''
						var peopleLists = ''
						var origanizeStr = ''
						var origanizeStrs = ''

						if (origanizeList.length) {
							for (var i = 0; i < origanizeList.length; i++) {
								peopleList = ''
								peopleLists = ''
								if (origanizeList[i].planOrgUserList && origanizeList[i].planOrgUserList.length > 0) {
									for (var j = 0; j < origanizeList[i].planOrgUserList.length; j++) {
										peopleList += '<li data-id="' + origanizeList[i].planOrgUserList[j].id +
											'"data-name="' + origanizeList[i].planOrgUserList[j].userName +
											'"><img src="img/icon_3.png" alt="">' + origanizeList[i].planOrgUserList[j].userName +
											'</li>'
										peopleLists += '<li data-id="' + origanizeList[i].planOrgUserList[j].id +
											'"data-name="' + origanizeList[i].planOrgUserList[j].userName +
											'">' + origanizeList[i].planOrgUserList[j].userName +
											'<img src="img/icon_4.png" alt=""><span></span></li>'
									}
								}
								origanizeStr +=
									'<div class="org"><div class="org-tit"><p class="slo">' +
									origanizeList[i].orgName + '</p></div><ul class="user_list">' +
									peopleList + '</ul></div>'
								origanizeStrs +=
									'<div class="org"><div class="org-tit"><p class="slo">' +
									origanizeList[i].orgName + '</p></div><ul class="user_list">' +
									peopleLists + '</ul></div>'
							}

							$('.orgList').html(origanizeStrs)
							$('.table-content').html(origanizeStr)

							bindOrgClick();
						}
					}
				})
			}

			function bindOrgClick() { //组织人员 选择点击事件
				$('.table-content .org').on('click', function() {
					if ($(this).hasClass('active')) {
						$(this).removeClass('active')
					} else {
						$(this).addClass('active')
					}
				})
				$('.table-content .org .user_list li').on('click', function(event) {
					event.stopPropagation();
					var data = {
						id: $(this).data('id'),
						name: $(this).data('name')
					}
					if ($(this).hasClass('active')) {
						$(this).removeClass('active')
						for (var i = 0; i < newsCandidate.length; i++) {
							if(newsCandidate[i].id == data.id){
								newsCandidate.splice(i, 1);
							}
						}
						createNewsCandidate()
					} else {
						$(this).addClass('active')
						newsCandidate.push(data)
						createNewsCandidate()
					}
				})
				$('.popupOne .orgList .org').on('click', function() {
					if ($(this).hasClass('active')) {
						$(this).removeClass('active')
					} else {
						$(this).addClass('active')
					}
				})
				$('.popupOne .orgList .org .user_list li').on('click', function(event) {
					event.stopPropagation();
					var data = {
						id: $(this).data('id'),
						name: $(this).data('name')
					}
					if ($(this).hasClass('active')) {
						$(this).removeClass('active')
						for (var i = 0; i < voiceCandidate.length; i++) {
							if(voiceCandidate[i].id == data.id){
								voiceCandidate.splice(i, 1);
							}
						}
						createVoiceCandidate()
					} else {
						$(this).addClass('active')
						voiceCandidate.push(data)
						createVoiceCandidate()
					}
				})
			}

			function createCamera(){ //渲染摄像头
				var cameraHtml = ''
				for (var i = 0; i < videoDistribution.length; i++) {
					cameraHtml += "<li data-key=" + i + "><p>" + videoDistribution[i].name + "</p><span>" + videoDistribution[i].value + "</span></li>"
				}
				$('.cameraList').html(cameraHtml)
				$('.cameraList li').on('click',function(){ //摄像头点击事件
					if(CurrentScreenObj){
						var key = $(this).data('key')
						var val = CurrentScreenObj.find('.number').text();
						var data = isVideoDistribution(val);
						if(data){
							if(data.value != val){
								videoDistribution[key].value = val
								createCamera()
								createMonitorScreen()
							}else{
								for (var n = 0; n < videoDistribution.length; n++) {
									if(videoDistribution[n] == data){
										videoDistribution[n].value = ''
									}
								}
								videoDistribution[key].value = val
								createCamera()
								createMonitorScreen()
							}
						}else{
							videoDistribution[key].value = val
							createCamera()
							createMonitorScreen()
						}
					}else{
						alert('请先选择监控屏幕！')
					}
				})
			}

			function createMonitorScreen(){ //渲染当前屏幕
				var monitorScreenHtml = ''
				if(videoSettingType == 1){
					$('.splitScreenFour').addClass('active')
					for (var i = 0; i < 4; i++) {
						var data = isVideoDistribution("监控" + (i+1));
						if(data){
							if(CurrentScreenObj && CurrentScreenObj.find('.number').text() == "监控" + (i+1)){
								monitorScreenHtml += "<li class='v-s-4 enable active'><div class='number'>监控" + (i+1) + "</div><div class='name'>" + data.name + "</div><div class='close'><i class='iconfont icon-guanbi'></i></div></li>"
							}else{
								monitorScreenHtml += "<li class='v-s-4 enable'><div class='number'>监控" + (i+1) + "</div><div class='name'>" + data.name + "</div><div class='close'><i class='iconfont icon-guanbi'></i></div></li>"
							}

						}else{
							if(CurrentScreenObj && CurrentScreenObj.find('.number').text() == "监控" + (i+1)){
								var val = CurrentScreenObj.find('.number').text();
								monitorScreenHtml += "<li class='v-s-4 active'><div class='number'>监控" + (i+1) + "</div><div class='name'>请选择画面</div><div class='close'><i class='iconfont icon-guanbi'></i></div></li>"
							}else{
								monitorScreenHtml += "<li class='v-s-4'><div class='number'>监控" + (i+1) + "</div><div class='name'>请选择画面</div><div class='close'><i class='iconfont icon-guanbi'></i></div></li>"
							}
						}
					}
				}else if(videoSettingType == 2){
					$('.splitScreenNine').addClass('active')
					for (var i = 0; i < 9; i++) {
						var data = isVideoDistribution("监控" + (i+1));
						if(data){
							if(CurrentScreenObj && CurrentScreenObj.find('.number').text() == "监控" + (i+1)){
								monitorScreenHtml += "<li class='v-s-9 enable active'><div class='number'>监控" + (i+1) + "</div><div class='name'>" + data.name + "</div><div class='close'><i class='iconfont icon-guanbi'></i></div></li>"
							}else{
								monitorScreenHtml += "<li class='v-s-9 enable'><div class='number'>监控" + (i+1) + "</div><div class='name'>" + data.name + "</div><div class='close'><i class='iconfont icon-guanbi'></i></div></li>"
							}
						}else{
							if(CurrentScreenObj && CurrentScreenObj.find('.number').text() == "监控" + (i+1)){
								monitorScreenHtml += "<li class='v-s-9 active'><div class='number'>监控" + (i+1) + "</div><div class='name'>请选择画面</div><div class='close'><i class='iconfont icon-guanbi'></i></div></li>"
							}else{
								monitorScreenHtml += "<li class='v-s-9'><div class='number'>监控" + (i+1) + "</div><div class='name'>请选择画面</div><div class='close'><i class='iconfont icon-guanbi'></i></div></li>"
							}
						}

					}
				}
				$('.monitorScreenList').html(monitorScreenHtml)
				$('.monitorScreenList li').on('click',function(){
					if(!$(this).hasClass('active')){
						$('.monitorScreenList li').removeClass('active')
						$(this).addClass('active')
						$(this).find('number').text()
						CurrentScreenObj = $(this);
					}
				})
				$('.monitorScreenList li .close').on('click',function(event){
					event.stopPropagation()
					var val = $(this).siblings('.number').text()
					for (var n = 0; n < videoDistribution.length; n++) {
						if(videoDistribution[n].value == val){
							videoDistribution[n].value = ''
						}
					}
					createCamera()
					createMonitorScreen()
				})
			}

			function isVideoDistribution(val){ //判断当前屏幕是否有画面
				var data = false
				for (var i = 0; i < videoDistribution.length; i++) {
					if(videoDistribution[i].value == val){
						data = videoDistribution[i]
					}
				}
				return data
			}

			function getCameraList() { //获取摄像头数据
				// 				$.ajax({
				// 					type: 'GET',
				// 					url: RES_HOST + '/plan/planManagement/getPlanInfo?planId=' + planId,
				// 					success: function(result) {
				//
				// 					}
				// 				})
				var data = {
					list:[
						{
							name: '桃花镇分点',
							value: ''
						},
						{
							name: '幸福村站点',
							value: '监控1'
						},
						{
							name: '文明街道1',
							value: '监控2'
						},
						{
							name: '五一大道中段',
							value: '监控3'
						},
						{
							name: '芙蓉广场',
							value: ''
						}
					],
					videoSettingType: 2,

				}
				videoSettingType = data.videoSettingType
				videoDistribution = data.list
				//渲染摄像头
				createCamera()
				//渲染监控屏
				createMonitorScreen()
				//屏幕分配方式切换事件绑定
				$('.splitScreenFour').on('click',function(){
					if(!$(this).hasClass('active')){
						CurrentScreenObj = ''
						$(this).addClass('active')
						$('.splitScreenNine').removeClass('active')
						videoSettingType = 1
						createMonitorScreen()
					}
				})
				$('.splitScreenNine').on('click',function(){
					if(!$(this).hasClass('active')){
						CurrentScreenObj = ''
						$(this).addClass('active')
						$('.splitScreenFour').removeClass('active')
						videoSettingType = 2
						createMonitorScreen()
					}
				})
			}

			function resetObject(url) {
				var vlc = document.getElementById('vlc1');
				vlc.playlist.clear();
				vlc.playlist.add(url);
				vlc.playlist.play();
				$('.swiper-slide ul li').removeClass('active');
				$('.sure-btn').hide();
			}

			function presentTime() {
				var myDate = new Date();
				$('#current-date span').text((myDate.getHours() < 10 ? '0' + myDate.getHours() : myDate.getHours()) + ':' + (
					myDate
					.getMinutes() < 10 ? '0' + myDate.getMinutes() : myDate.getMinutes()) + ':' + (myDate.getSeconds() < 10 ? '0' +
					myDate.getSeconds() : myDate.getSeconds()))
			}

			function mapInit() {
				window.initialize = function() {
					/* eslint-disable */
					var bdMap = new BMap.Map('bdMap')
					var bdGeo = new BMap.Geocoder()

					bdMap.setMapStyle({
						style: 'midnight'
					});
					bdMap.enableScrollWheelZoom()

					bdMap.addControl(new BMap.NavigationControl())
					// bdMap.addControl(new BMap.OverviewMapControl())
					// bdMap.addControl(new BMap.PanoramaControl())

					var plants = [{
							address: '电厂路口',
							city: '珠海市',
							id: 1
						},
						{
							address: '',
							city: '靖海市',
							id: 2
						},
						{
							address: '',
							city: '湛江市',
							id: 3
						},
						{
							address: '红海湾发电厂粤红宾馆',
							city: '汕尾市',
							id: 4
						},
						{
							address: '',
							city: '东莞市',
							id: 5
						}
					]
					var myIcon = new BMap.Icon('img/img_dc.png', new BMap.Size(23, 25));
					plants.forEach(function(t, k) {
						bdGeo.getPoint(t.address, function(point) {
							if (!point) return
							var marker = new BMap.Marker(point, {
								icon: myIcon,
								title: t.city + t.address
							})
							bdMap.addOverlay(marker)
						}, t.city)
					})
					var points = new BMap.Point(110.30765, 25.240049);
					bdGeo.getPoint('广州市', function(point) {
						bdMap.centerAndZoom(points, 8)
					})
				}
			}

			function videoHtml(Callback) {

				Callback && Callback()
			}

			function videoClickEvent() {
				$('.zoomBut').on('click', function() {
					if ($('.c-v-list').eq(0).hasClass('active')) {
						$('.c-v-list').eq(0).removeClass('active')
						$('.c-v-list').eq(1).addClass('active')
					} else {
						$('.c-v-list').eq(0).addClass('active')
						$('.c-v-list').eq(1).removeClass('active')
					}
				})
				$('.video-title .but').on('click', function() {
					$('.popupTow').show()
				})
			}

			function PageInitClickEvent(){ //页面初始化点击事件
				$('.video .title .tabBut').on('click', function() {
					var index = $(this).index()
					if ($(this).hasClass('active')) {
						return
					}
					$('.video .title .tabBut').removeClass('active')
					$(this).addClass('active')
					$('.tab-content').removeClass('active')
					$('.tab-content').eq(index).addClass('active')
				})

				$('.swiper-slide ul li').click(function() {
					if ($('.swiper-slide ul li.active').length < 4 || $(this).hasClass('active')) {
						$(this).toggleClass('active')
					}
					if ($('.swiper-slide ul li.active').length > 0) {
						$('.sure-btn').show();
					} else {
						$('.sure-btn').hide();
					}
				})

				$('.but-list .but1').on('click',function(){
					$('.popupOne').show()
					$('.popupTow').hide()
					$('.popupThree').hide()
				})

				$('.but-list .but3').on('click',function(){
					$('.popupThree').show()
					$('.popupOne').hide()
					$('.popupTow').hide()
				})

				$('#videoAdjustSure').on('click',function(){
					$('.popupTow').hide()
				})
				$('#videoAdjustCancel').on('click',function(){
					$('.popupTow').hide()
				})

				$('#VoiceSure').on('click',function(){
					voiceCandidate = []
					$('.popupOne').hide()
				})
				$('#VoiceCancel').on('click',function(){
					$('.popupOne').hide()
				})

				$('#newsSure').on('click',function(){
					voiceCandidate = []
					$('.popupThree').hide()
				})
				$('#newsCancel').on('click',function(){
					$('.popupThree').hide()
				})
			}

			$(function() {
				// initPage() //初始化时间日期
				initPageWidthHeight() //计算屏幕宽高

				getMaterialList() // 获取应急物资列表

				getOriganizeList() //组织人员

				getCameraList() //摄像

				mapInit() //地图初始化

				presentTime()
				setInterval(function() {
					presentTime()
				}, 1000)

				PageInitClickEvent()
				// var mySwiper = new Swiper('.swiper-container', {
				//   direction: 'vertical',
				//   loop: true,
				//   // 如果需要分页器
				//   pagination: '.swiper-pagination',
				//   autoplay: 5000
				// })

				var videoFullHeight = $('.c-v-list').height()
				var videoFullWidth = $('.c-v-list').width()
				var flag = 0;
				videoHtml(function() {
					videoClickEvent()
				})
				// 				$('.c-vs').click(function() {
				// 					if (!flag) {
				// 						flag = 1;
				// 						$('.c-vs').hide();
				// 						$(this).show();
				// 						$(this).find('p').hide();
				// 						$(this).find('.c-vs-video').height(videoFullHeight + 'px')
				// 						$(this).find('.c-vs-video').width(videoFullWidth + 'px');
				// 						$(this).find('.c-vs-video').find('object').width(videoFullWidth + 'px');
				// 						$(this).find('.c-vs-video').find('object').height(videoFullHeight + 'px');
				// 					} else {
				// 						flag = 0;
				// 						$('.c-vs').show()
				// 						$(this).find('p').show();
				// 						$(this).find('.c-vs-video').height('86%')
				// 						$(this).find('.c-vs-video').width('100%');
				// 					}
				// 				})
				//
				// 				$('.sure-btn').click(function() {
				// 					for (var i = 0; i < $('.swiper-slide ul li').length; i++) {
				// 						if ($('.swiper-slide ul li').eq(i).hasClass('active')) {
				// 							resetObject($('.swiper-slide ul li').eq(i).find('img').attr('value'))
				// 						}
				// 					}
				//
				// 					for (var i = 0; i < $('.swiper-slide ul li.active').length; i++) {
				// 					 $('.c-vs').eq(i).find('.c-vs-video').html('')
				// 					$('.c-vs').eq(i).find('.c-vs-video').html("<OBJECT classid='clsid:9BE31822-FDAD-461B-AD51-BE1D1C159921' codebase='http://downloads.videolan.org/pub/videolan/vlc-webplugins/2.0.6/npapi-vlc-2.0.6.tar.xz' id='aaa' name='vlc' events='True'><param name='Src'value=" +'rtsp://184.72.239.149/vod/mp4://BigBuckBunny_175k.mov'+ " /><param name='ShowDisplay' value='True' /><param name='AutoLoop' value='False' /><param name='AutoPlay' value='True' /></OBJECT>")
				// 					var x = document.createElement("param");
				// 					x.setAttribute("name","Src");
				// 					x.setAttribute("value","rtsp://184.72.239.149/vod/mp4://BigBuckBunny_175k.mov");
				// 					document.getElementById("vlc1").appendChild(x);
				//
				// 					var vlc = document.getElementById('vlc1');
				// 					vlc.playlist.clear();
				// 					vlc.playlist.add('rtsp://184.72.239.149/vod/mp4://BigBuckBunny_175k.mov');
				// 					vlc.playlist.play();
				// 					$('.swiper-slide ul li').removeClass('active');
				// 					$('.sure-btn').hide();
				// 					}
				// 				})
				// 				$.ajax({
				// 					type: 'GET',
				// 					url: RES_HOST + '/plan/planManagement/findList?id=' + planId,
				// 					success: function(result) {
				// 						console.log(result);
				// 					}
				// 				})
			})
		</script>
	</body>

</html>
