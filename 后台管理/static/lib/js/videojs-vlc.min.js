/*! videojs-vlc - v0.2.0 - 2017-05-11
* Copyright (c) 2017 Afterster; Licensed Apache-2.0 */
videojs.Vlc=videojs.MediaTechController.extend({init:function(a,b,c){videojs.MediaTechController.call(this,a,b,c);var d=b.source,e=a.id()+"_vlc_api",f=this;this.player_=a;var g=videojs.util.mergeOptions({animationatstart:"true",transparentatstart:"true",windowless:"true",controls:"false",bgcolor:"#000000",autostart:a.options().autoplay?"true":"false",allowfullscreen:"true",text:"Video.js VLC plug-in"},b.params);d&&(g.source=d.src,this.ready(function(){this.setSrc(d.src),a.options().autoplay&&this.play()}));var h=videojs.util.mergeOptions({id:e,name:e,class:"vjs-tech"},b.attributes),i=b.parentEl,j=this.el_=videojs.Component.prototype.createEl("div",{id:a.id()+"temp_vlc"});i.firstChild?i.insertBefore(j,i.firstChild):i.appendChild(j),a.on("fullscreenchange",function(){var a=f.getApi().input.position;f.getApi().playlist.stop(),f.getApi().playlist.play(),f.getApi().input.position=a}),b.startTime&&this.ready(function(){this.load(),this.play(),this.currentTime(b.startTime)}),a.ready(function(){}),this.el_=videojs.Vlc.embed(j,g,h),this.el_.tech=this,videojs.Vlc.registerEvent(this.getApi(),"MediaPlayerOpening",function(){a.trigger("loadstart")}),videojs.Vlc.registerEvent(this.getApi(),"MediaPlayerBuffering",function(){a.trigger("loadeddata"),a.trigger("volumechange")}),videojs.Vlc.registerEvent(this.getApi(),"MediaPlayerPlaying",function(){a.trigger("play"),a.trigger("playing")}),videojs.Vlc.registerEvent(this.getApi(),"MediaPlayerPaused",function(){a.trigger("pause")}),videojs.Vlc.registerEvent(this.getApi(),"MediaPlayerStopped",function(){a.trigger("pause"),a.trigger("ended")}),videojs.Vlc.registerEvent(this.getApi(),"MediaPlayerEndReached",function(){a.trigger("pause"),a.trigger("ended")}),videojs.Vlc.registerEvent(this.getApi(),"MediaPlayerTimeChanged",function(){a.trigger("timeupdate")}),videojs.Vlc.registerEvent(this.getApi(),"MediaPlayerPositionChanged",function(){a.trigger("progress")}),videojs.Vlc.registerEvent(this.getApi(),"MediaPlayerLengthChanged",function(){a.trigger("durationchange")}),setTimeout(function(){f.triggerReady()},100)}}),videojs.Vlc.prototype.params=[],videojs.Vlc.prototype.dispose=function(){this.el_&&this.el_.parentNode.removeChild(this.el_),videojs.MediaTechController.prototype.dispose.call(this)},videojs.Vlc.prototype.src=function(a){return void 0===a?this.currentSrc():this.setSrc(a)},videojs.Vlc.prototype.setSrc=function(a){a=videojs.Vlc.getAbsoluteURL(a),this.getApi().playlist.items.clear(),this.getApi().playlist.add(a)},videojs.Vlc.prototype.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.getApi().playlist.items[this.getApi().playlist.currentItem]},videojs.Vlc.prototype.load=function(){},videojs.Vlc.prototype.poster=function(){this.el_.vjs_getProperty("poster")},videojs.Vlc.prototype.setPoster=function(){},videojs.Vlc.prototype.play=function(){this.getApi().playlist.play()},videojs.Vlc.prototype.ended=function(){var a=this.getApi().input.state;return 6===a||7===a},videojs.Vlc.prototype.pause=function(){this.getApi().playlist.pause()},videojs.Vlc.prototype.paused=function(){var a=this.getApi().input.state;return 4===a||6===a},videojs.Vlc.prototype.currentTime=function(){return this.getApi().input.time/1e3},videojs.Vlc.prototype.setCurrentTime=function(a){this.getApi().input.time=1e3*a},videojs.Vlc.prototype.duration=function(){return this.getApi().input.length/1e3},videojs.Vlc.prototype.buffered=function(){return[]},videojs.Vlc.prototype.volume=function(){return this.getApi().audio.volume/100},videojs.Vlc.prototype.setVolume=function(a){a&&(this.getApi().audio.volume=100*a)},videojs.Vlc.prototype.muted=function(){return this.getApi().audio.mute},videojs.Vlc.prototype.setMuted=function(a){this.getApi().audio.mute.mute=a},videojs.Vlc.prototype.supportsFullScreen=function(){return!0},videojs.Vlc.prototype.enterFullScreen=function(){this.getApi().video.fullscreen=!0,this.player_.trigger("fullscreenchange")},videojs.Vlc.prototype.exitFullScreen=function(){this.getApi().video.fullscreen=!1,this.player_.trigger("fullscreenchange")},videojs.Vlc.prototype.getApi=function(){return this.el_},videojs.Vlc.registerEvent=function(a,b,c){a&&(a.attachEvent?a.attachEvent(b,c):a.addEventListener?a.addEventListener(b,c,!1):a["on"+b]=c)},videojs.Vlc.unregisterEvent=function(a,b,c){a&&(a.detachEvent?a.detachEvent(b,c):a.removeEventListener?a.removeEventListener(b,c,!1):a["on"+b]=null)},videojs.Vlc.embed=function(a,b,c){var d=videojs.Vlc.getEmbedCode(b,c),e=videojs.Component.prototype.createEl("div",{innerHTML:d}).childNodes[0];a.parentNode;return a.parentNode.replaceChild(e,a),e},videojs.Vlc.getEmbedCode=function(a,b){var c,d,e="",f="";if(window.ActiveXObject){c='<object classid="clsid:9BE31822-FDAD-461B-AD51-BE1D1C159921" codebase="http://download.videolan.org/pub/videolan/vlc/last/win32/axvlc.cab" ',b=videojs.util.mergeOptions({width:"100%",height:"100%",tabindex:"-1"},b);for(d in a)e+='<param name="'+d+'" value="'+a[d]+'" />';for(d in b)f+=d+'="'+b[d]+'" ';return c+f+">"+e+"</object>"}c='<embed type="application/x-vlc-plugin" pluginspage="http://www.videolan.org" ',b=videojs.util.mergeOptions(a,b);for(d in b)f+=d+'="'+b[d]+'" ';return c+f+"/>"},videojs.Vlc.getAbsoluteURL=function(a){return a.match(/^https?:\/\//)||(a=videojs.Component.prototype.createEl("div",{innerHTML:'<a href="'+a+'">x</a>'}).firstChild.href),a},videojs.Vlc.isSupported=function(){var a;if(window.ActiveXObject)try{a=new window.ActiveXObject("VideoLAN.VLCPlugin.2")}catch(d){}else if(navigator.plugins&&navigator.mimeTypes.length>0){var b="VLC";if(navigator.plugins&&navigator.plugins.length>0)for(var c=0;c<navigator.plugins.length;++c)if(-1!==navigator.plugins[c].name.indexOf(b))return a=navigator.plugins[c],!0}else if(obj=document.getElementById("test_vlc"),null===obj&&(obj=document.createElement("embed"),obj.setAttribute("style","width:0px; height:0px;"),obj.setAttribute("type","application/x-vlc-plugin"),obj.setAttribute("id","test_vlc"),document.body.appendChild(obj)),void 0!==obj.playlist)return obj.parentNode.removeChild(obj),!0;return!!a},videojs.Vlc.canPlaySource=function(a){return"maybe"};